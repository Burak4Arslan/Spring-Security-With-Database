<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>

    <meta charset="UTF-8">

    <title>Home</title>

    <div th:replace="fragments/myCSS :: defaultCSS"></div>

</head>

<body>

<div class="wrapper">

    <h1 id="homepageHeader">HOMEPAGE</h1>

    <a href="/secured">See All Users</a>

    <p th:unless="${#httpServletRequest.remoteUser}">
        <p><input type="text" placeholder="Username" id="username"></p>
        <p><input type="password" placeholder="Password" id="password"></p>
        <p><button id="signButton">Sign in</button></p>
    </p>

    <div th:if="${param.logout}">
        <div class="alert alert-info">
            You have been logged out.
        </div>
    </div>

    <div th:replace="fragments/footer :: footer"/>

</div>

<script>

    document.getElementById("signButton").addEventListener("click",()=> {

        let username = document.getElementById("username").value;
        let password = document.getElementById("password").value;

        let user = {
            "username" : username,
            "password" : password
        }

        var saveUserRequest = new XMLHttpRequest();
        saveUserRequest.onreadystatechange = () => {
            // console.log(saveUserRequest.response);
            if (saveUserRequest.readyState == 4 && saveUserRequest.status == 200){
                console.log(saveUserRequest.response);
            }
        }
        saveUserRequest.open("POST","http://localhost:8080/users", true);
        saveUserRequest.setRequestHeader("Content-Type", "application/json");
        saveUserRequest.send(JSON.stringify(user));

    })

</script>

</body>

</html>